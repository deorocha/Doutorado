InterpolaÃ§Ã£o e PrevisÃ£o de PrecipitaÃ§Ã£o por Redes Neurais
Convolucionais para Grafos
Augusto Fonseca
augusto.fonseca@aluno.cefet-rj.br
CEFET/RJ
Ronaldo Goldschimidt
IME/RJ
ronaldo.rgold@ime.eb.br
Eduardo Ogasawara
CEFET/RJ
eogasawara@ieee.org
Mariza Ferro
IC/UFF
mariza@ic.uff.br
FÃ¡bio Porto
LNCC
fporto@lncc.br
Eduardo Bezerra
CEFET/RJ
ebezerra@cefet-rj.br
WebMediaâ€™2024, Juiz de Fora, Brazil
Fonseca et al.
AlÃ©m desta introduÃ§Ã£o, a SeÃ§Ã£o 2 aborda a metodologia utilizada
neste trabalho e detalhada as fontes dos dados meteorolÃ³gicos utili-
zados e os procedimentos de prÃ©-processamento aplicados. A SeÃ§Ã£o
3 detalha a configuraÃ§Ã£o do experimento e apresenta os resultados
obtidos. Finalmente, a SeÃ§Ã£o 4 destaca as principais conclusÃµes e
apresenta as direÃ§Ãµes de trabalhos futuros.
METODOLOGIA
Na Figura 1 Ã© apresentada uma visÃ£o geral da tÃ©cnica de interpola-
Ã§Ã£o proposta neste trabalho. Os dados coletados pelos instrumentos
meteorolÃ³gicos sÃ£o introduzidos na rede na forma de sÃ©ries tem-
porais de grafos. As camadas da GCN tÃªm a tarefa de aprender
a interpolar os dados. Os dados interpolados sÃ£o entÃ£o passados
como entrada para uma CNN que aprende os padrÃµes espaciais e
temporais processando a tarefa de regressÃ£o. Como saÃ­da, a rede
gera as previsÃµes da variÃ¡vel meteorolÃ³gica de interesse para passos
de tempo futuros.
Figura 1: VisÃ£o geral da arquitetura. As sÃ©ries temporais de
grafos sÃ£o passadas como entrada para a GCN que interpola
os dados. Os dados interpolados sÃ£o passados para a CNN que
aprende os padrÃµes espacias e temporais dos dados e gera as
prediÃ§Ãµes.
O problema aqui abordado consiste em uma tarefa de aprendi-
zado semi-supervisionado, uma vez que nÃ£o conhecemos o valor
de precipitaÃ§Ã£o para toda a Ã¡rea de interesse. Cada instrumento
meteorolÃ³gico coleta diferentes subconjuntos de variÃ¡veis. AlÃ©m
disso, decisÃµes estratÃ©gicas ou falhas nos equipamentos podem in-
terromper o monitoramento por horas, ou atÃ© mesmo dias. Dado
esse cenÃ¡rio, poderÃ­amos modelar o problema para aprendizado so-
bre grafos heterogÃªneos e dinÃ¢micos, i.e., grafos em que os vÃ©rtices
possuem diferentes atributos e que variam sua topologia ao longo
do tempo. No entanto, para fins de simplificaÃ§Ã£o, modelamos o pro-
blema como aprendizado sobre grafos homogÃªneos e estÃ¡ticos. Para
viabilizar tal modelagem, aplicamos tÃ©cnicas sobre o processamento
dos dados abordadas na SeÃ§Ã£o 2.2.
Formalmente, o problema Ã© definido como segue. Considere que
G(ğ‘¡) =

V, E, X(ğ‘¡)
represente um grafo homogÃªneo no passo
de tempo ğ‘¡âˆˆ{1, 2, ...,ğ‘‡}. V representa as coordenadas (latitude,
longitude) que Ã© definido pela uniÃ£o de coordenadas de uma grade
regular de aproximadamente 3 km de resoluÃ§Ã£o e as coordenadas
associadas Ã s ETs. E Ã© definido por um limiar de distÃ¢ncia entre
as coordenadas empregando a distÃ¢ncia Haversine. X âˆˆR|V|Ã—ğ‘‘
representa a matriz de caracterÃ­sticas (variÃ¡veis meteorolÃ³gicas)
associadas aos vÃ©rtices. O modelo de interpolaÃ§Ã£o Ã© treinado para
aproximar uma funÃ§Ã£o ğ‘“(Â·) que mapeia uma sequÃªncia de variÃ¡-
veis meteorolÃ³gicas observadas para uma grade regular de valores
de precipitaÃ§Ã£o: Z(ğ‘¡) = ğ‘“(G(ğ‘¡), G(ğ‘¡âˆ’1), . . . , G(ğ‘¡âˆ’ğ‘‡âˆ’1)), em que ğ‘‡
representa o tamanho da sÃ©rie temporal de entrada e Z representa
a matriz de valores de precipitaÃ§Ã£o interpolados.
2.1
Dados MeteorolÃ³gicos
O experimento empregou duas fontes de dados. A primeira Ã© relativa
ao radar meteorolÃ³gico do INEA instalado na coordenada (lat: -
22.99325, lon: -43.58794). A segunda corresponde a ETs do INMET
e do Sistema Alerta Rio. A Figura 2 apresenta a localizaÃ§Ã£o dos
instrumentos. O radar do INEA Ã© do tipo banda S, dupla polarizaÃ§Ã£o,
em operaÃ§Ã£o desde 2015 e fornece, dentre outras variÃ¡veis, dados de
refletividade1 na atmosfera com resoluÃ§Ã£o espacial de 500 metros. A
cada 5 min o radar escaneia a atmosfera em 360Âº de azimute, em sete
nÃ­veis de altitude, em um raio de abrangÃªncia de 250 km. Dentre as
33 ETs do Alerta Rio, dois sÃ£o estaÃ§Ãµes meteorolÃ³gicas completas,
cinco sÃ£o estaÃ§Ãµes meteorolÃ³gicas parciais, i.e., nÃ£o observam todas
as variÃ¡veis meteorolÃ³gicas e 26 sÃ£o pluviÃ´metros, com resoluÃ§Ã£o
temporal de 15 minutos. As variÃ¡veis meteorolÃ³gicas observadas
sÃ£o pressÃ£o atmosfÃ©rica (mB), temperatura (Â°C), ponto de orvalho
(Â°C), umidade relativa do ar (%), direÃ§Ã£o do vento (Â°(gr)), velocidade
do vento (m/s) e precipitaÃ§Ã£o (mm). As quatro estaÃ§Ãµes do INMET
sÃ£o meteorolÃ³gicas completas, com resoluÃ§Ã£o temporal de uma
hora. Usamos as seguintes categorias de precipitaÃ§Ã£o definidas pela
equipe do sistema Alerta Rio, conforme a quantidade de precipitaÃ§Ã£o
observada em mm/h, a seguir: i) fraca: [0, 5); ii) moderada: [5, 25);
iii) forte: [25, 50) e; iv) extrema: [50,ğ‘–ğ‘›ğ‘“).
Figura 2: LocalizaÃ§Ã£o dos instrumentos de observaÃ§Ã£o. Pon-
tos em verde representam os pluviÃ´metros do Alerta Rio. Os
Ã­cones de informaÃ§Ã£o nas cores verde, laranja e azul represen-
tam, respectivamente, as estaÃ§Ãµes meteorolÃ³gicas do Alerta
Rio, as estaÃ§Ãµes meteorolÃ³gicas do INMET e o radar mete-
orolÃ³gico do INEA. O Ã­cone de estrela representa a estaÃ§Ã£o
tijuca_muda.
2.2
PrÃ©-processamento dos Dados
Dados de precipitaÃ§Ã£o tÃªm por caracterÃ­stica serem significativa-
mente desbalanceados, i.e., muitos dias sem chuva. AlÃ©m disso, o
1A refletividade Ã© uma das variÃ¡veis registradas a partir do eco gerado pelas ondas ele-
tromagnÃ©ticas irradiadas pelo radar. Essa variÃ¡vel detecta a presenÃ§a de hidrometeoros
na atmosfera, tais como Ã¡gua, gelo e neve.
InterpolaÃ§Ã£o e PrevisÃ£o de PrecipitaÃ§Ã£o por Redes Neurais Convolucionais para Grafos
WebMediaâ€™2024, Juiz de Fora, Brazil
volume de dados gerados pelo radar do INEA Ã© de cerca de 1,3 GB
por dia. Por conta disso, foram selecionados somente os dias em
que ocorreu chuva acumulada em uma hora acima de 25 milÃ­me-
tros. Para cada dia selecionado, o dia anterior tambÃ©m foi incluÃ­do,
totalizando 224 datas entre 2016 e 2023. Os dados de radar foram
agregados espacialmente para cada vÃ©rtice em G com base nas ob-
servaÃ§Ãµes em um raio de 1,5 km a partir do vÃ©rtice, em resoluÃ§Ã£o
temporal horÃ¡ria, limitado Ã s observaÃ§Ãµes atÃ© 2 km de altitude de-
vido ao efeito conhecido como cone do silÃªncio2. No processo de
agregaÃ§Ã£o foram geradas as features mÃ©dia, mÃ­nimo, mÃ¡ximo, 1Âº
quartil, mediana e 3Âº quartil em relaÃ§Ã£o Ã  refletividade observada
dentro do raio.
Os dados das estaÃ§Ãµes do Alerta Rio e INMET passaram por um
processo de curadoria em que foram tratadas as seguintes questÃµes:
i) duplicatas temporais, i.e., dois ou mais registros para a mesma
tupla (coordenada, horÃ¡rio) com valores distintos observados;
ii) perÃ­odo de operaÃ§Ã£o da estaÃ§Ã£o e quantidade de registros espe-
rada por intervalo de tempo;
iii) dados faltantes;
iv) dados espÃºrios, i.e., valores fora do intervalo esperado para a
variÃ¡vel e;
v) outras questÃµes de qualidade encontradas durante a anÃ¡lise.
Os dados foram filtrados conforme as datas disponÃ­veis para
os dados de radar. Um ponto a ser ressaltado sÃ£o os falsos nulos
para a variÃ¡vel direÃ§Ã£o do vento, quando uma estaÃ§Ã£o meteorolÃ³-
gica registra velocidade 0.0 para a variÃ¡vel velocidade do vento. No
processo de imputaÃ§Ã£o, os falsos nulos receberam valor arbitrÃ¡rio
0.0. As variÃ¡veis associadas Ã  direÃ§Ã£o e velocidade do vento foram
transformadas para componentes cÃ­clicas3. A data/hora tambÃ©m foi
empregada como feature pelo mÃ©todo de transformaÃ§Ã£o usando o
seno e cosseno4. Os dados anteriores a 01/fev/22 foram selecionados
para compor o conjunto de treino e igual ou superior como con-
junto de teste. Os parÃ¢metros de normalizaÃ§Ã£o e imputaÃ§Ã£o foram
ajustados somente sobre o conjunto de treino para evitar vazamento
de dados. Foram empregados, respectivamente, a funÃ§Ã£o Min-max
e o algoritmo k-NN Imputer disponÃ­veis na biblioteca scikit-learn5.
Os dados de radar e de ETs foram integrados por junÃ§Ã£o outer
join. VariÃ¡veis nÃ£o observadas em uma determinada coordenada
receberam valor 0.0. Para distinguir os valores 0.0 verdadeiros, foi
adicionada uma variÃ¡vel binÃ¡ria marcadora de preenchimento para
cada variÃ¡vel meteorolÃ³gica. Por fim, os dados foram processados
em sÃ©ries temporais de grafos, em que os vÃ©rtices representam as
coordenadas e as arestas uma relaÃ§Ã£o entre coordenadas definida
por um limiar de distÃ¢ncia de 3,4 km. Cuidados especiais foram
tomados para evitar gerar sÃ©ries temporais nÃ£o contÃ­guas, uma vez
que nÃ£o tÃ­nhamos a sÃ©rie histÃ³rica completa. Ao final foram gerados
3.644 exemplos de treino ( 78%) e 1.012 exemplos de teste ( 22%).
EXPERIMENTOS E RESULTADOS
Nesta seÃ§Ã£o, descrevemos os experimentos realizados. Na SeÃ§Ã£o 3.1
descrevemos aspectos de configuraÃ§Ã£o, e na SeÃ§Ã£o 3.2 apresentamos
os resultados, junto com uma anÃ¡lise sobre os mesmos.
2Cone do silÃªncio. Uma porÃ§Ã£o da Ã¡rea acima e em torno do radar nÃ£o Ã© observada. O
tamanho da porÃ§Ã£o varia conforme o Ã¢ngulo de elevaÃ§Ã£o do radar.
3https://bit.ly/metpy-wind-vector-components
4https://bit.ly/kaggle-encoding-cyclical-features
5https://scikit-learn.org/stable/index.html
3.1
ConfiguraÃ§Ã£o do Experimento
Neste primeiro experimento buscamos investigar duas questÃµes: i) o
impacto sobre a acurÃ¡cia quando empregada a feature refletividade e;
ii) a influÃªncia dos dados de estaÃ§Ãµes vizinhas em uma determinada
coordenada de interesse. Para tal, escolhemos a estaÃ§Ã£o tijuca_muda
como estaÃ§Ã£o de interesse (EI) por apresentar a maior quantidade
de exemplos em duas das quatro categorias de precipitaÃ§Ã£o, sendo
elas moderada e forte. Em seguida foram identificadas as 11 esta-
Ã§Ãµes vizinhas (EV) mais prÃ³ximas da EI (ApÃªndice A). A anÃ¡lise
gradativa consistiu em processar 11 conjuntos distintos de datasets
(conjuntos de treino e teste), conforme detalhado na SeÃ§Ã£o 2.2. Em
cada conjunto, identificados e ordenados como {ğ‘£1, ğ‘£2, ..., ğ‘£11}, um
novo vizinho Ã© adicionado ao dataset, do mais prÃ³ximo para o mais
distante, cumulativamente aos jÃ¡ adicionados no conjunto anterior,
de forma que o conjunto ğ‘£1 possui apenas uma EV e o conjunto ğ‘£11
possui as 11 EVs. Importante ressaltar que os dados da EI nÃ£o sÃ£o
empregados em nenhuma fase do prÃ©-processamento, treinamento
e inferÃªncia, simulando portanto uma coordenada sem informaÃ§Ã£o
Ã  qual desejamos inferir por interpolaÃ§Ã£o.
A GCN empregada para treinar o modelo foi a desenvolvida por
Bai et al. [1] e se encontra implementada no framework PyTorch
Geometric Temporal6. Comparando a arquitetura implementada no
framework com a apresentada no artigo, identificamos um provÃ¡vel
erro de implementaÃ§Ã£o nas camadas que operam a convoluÃ§Ã£o tem-
poral. De fato, a nossa versÃ£o corrigida obteve melhores resultados
nos testes preliminares. A GCN foi definida com uma camada de
convoluÃ§Ã£o espaÃ§o-temporal conforme Bai et al. [1] e duas camadas
fully connected para operar, respectivamente, as embeddings e a
correlaÃ§Ã£o entre os vÃ©rtices. Como funÃ§Ã£o de custo foi empregada
a Mean Squared Error. A taxa de aprendizado foi configurada para
1 Ã— 10âˆ’3 e a rede foi treinada com batchs de tamanho 32. Foram
treinados dois modelos para cada dataset: o modelo gcn_r treinado
com todas as features e o modelo gcn em que a feature refletividade
Ã© removida.
3.2
Resultados e AnÃ¡lise
A Tabela 1 apresenta valores de RMSE por modelo e categoria para
cada dataset. Para eventos de precipitaÃ§Ã£o forte e extrema, os mo-
delos gcn e gcn_r apresentam melhores resultados em todos os
datasets, com erros significativamente menores em diversos casos,
chegando a um erro aproximadamente 82% menor para chuva ex-
trema no conjunto ğ‘£6 em relaÃ§Ã£o ao IDW. Outros destaques ocorrem
na categoria extrema para os conjuntos ğ‘£5 e ğ‘£10 e na categoria forte
para os conjuntos ğ‘£3 e ğ‘£4 que apresentam erros relativos entre 40%
e 50% abaixo do mÃ©todo IDW. Na categoria moderada o mÃ©todo
IDW obtÃ©m melhores resultados em todas os conjuntos, exceto o
conjunto ğ‘£1 e na categoria fraca ocorrem seis resultados a favor
do IDW contra cinco das GCN. Apesar disso, a diferenÃ§a de erro
entre os mÃ©todos nas categorias fraca e moderada Ã© relativamente
pequena em quase todos os datasets.
Quanto ao emprego da feature refletividade, a Tabela 1 apresenta
que o modelo treinado com a inclusÃ£o dessa feature retorna oito
melhores resultados para a categoria forte e seis para a categoria
extrema. A maioria dos resultados em todas as categorias apresen-
tam resultados prÃ³ximos quando comparados os modelos gcn e
6https://pytorch-geometric-temporal.readthedocs.io/en/latest/index.html
WebMediaâ€™2024, Juiz de Fora, Brazil
Fonseca et al.
Tabela 1: Resultados da anÃ¡lise gradativa para a estaÃ§Ã£o tijuca_muda (RMSE).
Categoria
Modelo
ğ‘£1
ğ‘£2
ğ‘£3
ğ‘£4
ğ‘£5
ğ‘£6
ğ‘£7
ğ‘£8
ğ‘£9
ğ‘£10
ğ‘£11
fraca
gcn
0.773
1.053
0.688
0.655
0.666
0.615
0.538
0.568
0.641
0.677
0.610
gcn_r
0.807
0.930
0.778
0.684
0.644
0.675
0.570
0.623
0.649
0.651
0.630
idw
0.799
0.544
0.521
0.522
0.614
0.608
0.621
0.599
0.626
0.663
0.658
moderada
gcn
4.839
5.512
4.521
4.688
3.807
3.834
3.720
3.941
3.930
4.771
3.733
gcn_r
4.890
5.681
4.593
4.285
3.875
3.881
4.065
3.836
4.133
4.059
3.887
idw
4.989
3.296
3.164
3.061
2.975
3.077
3.169
3.115
3.109
3.144
3.150
forte
gcn
9.843
6.078
6.285
6.862
9.639
10.450
9.756
11.997
11.599
8.304
12.903
gcn_r
9.417
6.606
5.663
6.947
7.196
9.426
8.976
10.617
9.908
11.624
11.134
idw
11.307
10.598
11.385
12.006
11.732
10.351
10.725
11.274
11.533
11.748
12.154
extrema
gcn
18.941
17.570
11.752
13.891
11.255
3.692
11.345
18.451
15.373
5.334
14.368
gcn_r
18.341
25.899
12.979
15.192
6.657
2.624
13.661
14.528
9.837
10.586
12.701
idw
18.400
18.241
16.403
17.477
16.069
14.881
15.166
17.400
18.250
19.052
18.293
gcn_r. No entanto, algumas exceÃ§Ãµes chamam a atenÃ§Ã£o. Por exem-
plo, na categoria extrema os resultados para os datasets ğ‘£2 e ğ‘£10
apresentam erro significativamente maior para o modelo treinado
com refletividade. Por outro lado, para os datasets ğ‘£5 e ğ‘£9 ocorre o
inverso, em que o modelo treinado com refletividade apresenta erro
significativamente menor.
A Figura 3 apresenta a variaÃ§Ã£o na acurÃ¡cia dos modelos a me-
dida que adicionamos informaÃ§Ãµes de EVs. Nas categorias fraca
e moderada, o erro tende a diminuir com a adiÃ§Ã£o de EVs, estabi-
lizando a partir da 5ğ‘EV adicionada. Na categoria forte, ocorre
um efeito nÃ£o esperado, em que a partir da 3ğ‘EV o erro tende a
crescer. Na categoria extrema, o erro diminui significativamente
atÃ© a adiÃ§Ã£o da 6ğ‘EV, momento em que o erro comeÃ§a a aumentar
novamente. JÃ¡ para o mÃ©todo IDW, o erro tende a permanecer cons-
tante conforme a adiÃ§Ã£o de EVs mais distantes, o que Ã© esperado
dada a formulaÃ§Ã£o matemÃ¡tica do prÃ³prio mÃ©todo, que pondera
inversamente as informaÃ§Ãµes de EVs mais distantes.
Figura 3: Impacto da acurÃ¡cia para o ponto de interesse a
medida que sÃ£o adicionados dados de vizinhos mais distantes.
CONCLUSÃƒO
Neste trabalho, nosso objetivo foi empregar GCNs na tarefa de
interpolaÃ§Ã£o e previsÃ£o de precipitaÃ§Ã£o. Para tal, treinamos GCNs
de forma semi-supervisionada empregando dados de radar mete-
orolÃ³gico e ETs. Por ser um trabalho em progresso, inicialmente
avaliamos a acurÃ¡cia da interpolaÃ§Ã£o estimada por uma GCN em
comparaÃ§Ã£o ao mÃ©todo estatÃ­stico IDW. Avaliamos os modelos com
foco em duas questÃµes: i) impacto sobre a acurÃ¡cia quando empre-
gados dados de radar e; ii) influÃªncia dos dados de estaÃ§Ãµes vizinhas
em uma determinada coordenada de interesse.
Foi observado que as GCNs obtÃªm melhor acurÃ¡cia em eventos
mais extremos de precipitaÃ§Ã£o e alcanÃ§am resultados promissores
em eventos de menor magnitude. Para eventos mais extremos, a
GCN chega a alcanÃ§ar resultados atÃ© 80% superiores em relaÃ§Ã£o
ao mÃ©todo IDW. AlÃ©m disso, nos experimentos em que o mÃ©todo
IDW obteve melhor resultado, a diferenÃ§a para o resultado alcan-
Ã§ado pela GCN foi relativamente pequena, mostrando o potencial
da abordagem. O emprego dos dados de radar aumentou frequen-
temente a acurÃ¡cia para eventos mais extremos. De forma geral,
a adiÃ§Ã£o de mais informaÃ§Ãµes vizinhas Ã  coordenada de interesse
aumentou a acurÃ¡cia da interpolaÃ§Ã£o no caso das GCNs. TambÃ©m
observou-se que, aumentar em demasia a quantidade de vizinhos
pode diminuir a acurÃ¡cia. Conforme esperado, o mÃ©todo IDW tende
a estabilizar conforme sÃ£o adicionados vizinhos mais distantes.
Como trabalhos futuros, pretendemos entender o motivo da di-
minuiÃ§Ã£o da acurÃ¡cia das abordagens por GCN quando da adiÃ§Ã£o de
certas EVs. Para tal, faremos anÃ¡lises separadas para cada evento em
que a GCN apresentou erro alto. Pretendemos tambÃ©m investigar
o motivo para a inclusÃ£o de dados de radar diminuir significativa-
mente a acurÃ¡cia em casos especÃ­ficos. TambÃ©m realizaremos os
mesmos experimentos com outras EI, explorando distribuiÃ§Ãµes es-
paciais distintas de vizinhanÃ§a. AlÃ©m disso, avaliaremos o impacto
com outras fontes de dados meteorolÃ³gicos (e.g. satÃ©lite).
ACKNOWLEDGMENTS
Agradecemos Ã  CAPES, ao CNPq, Ã  Faperj (Proc. E-26/210.242/2024)
e Instituto Serrapilheira (N Processo Serra â€“ 2211-41897), pelo finan-
ciamento parcial desta pesquisa; ao LNCC e ao Instituto de IA, por
ceder os recursos computacionais e apoio Ã  missÃµes de pesquisa; e
ao COR, Ã  GeoRio e ao INEA, pelo fornecimento dos dados usados
nos experimentos.
InterpolaÃ§Ã£o e PrevisÃ£o de PrecipitaÃ§Ã£o por Redes Neurais Convolucionais para Grafos
WebMediaâ€™2024, Juiz de Fora, Brazil
